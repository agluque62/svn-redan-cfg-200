(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{adXB:function(e,t,i){"use strict";i.r(t),i.d(t,"ResourceCollateralsComponent",function(){return G});var c=i("mrSG"),o=i("fXoL"),a=i("VITL"),s=i("9+1D"),n=i("plSC"),l=i("rkFe"),r=i("O1oF"),u=i("3Pt+"),d=i("kmnG"),b=i("qFsG"),m=i("bTqV"),p=i("d3UM"),h=i("ofXK"),f=i("FKr1"),g=i("bSwM");function C(e,t){if(1&e&&(o.Tb(0,"mat-option",21),o.yc(1),o.Sb()),2&e){const e=t.$implicit;o.kc("value",e.value),o.Cb(1),o.Ac(" ",e.viewValue," ")}}function v(e,t){1&e&&(o.Tb(0,"mat-checkbox",22),o.yc(1,"Options Response"),o.Sb())}function S(e,t){if(1&e&&(o.Tb(0,"mat-option",21),o.yc(1),o.Sb()),2&e){const e=t.$implicit;o.kc("value",e.value),o.Cb(1),o.Ac(" ",e.viewValue," ")}}function y(e,t){1&e&&(o.Tb(0,"mat-checkbox",23),o.yc(1,"Options Response"),o.Sb())}function O(e,t){if(1&e&&(o.Tb(0,"mat-option",21),o.yc(1),o.Sb()),2&e){const e=t.$implicit;o.kc("value",e.value),o.Cb(1),o.Ac(" ",e.viewValue," ")}}function k(e,t){if(1&e&&(o.Tb(0,"mat-form-field",9),o.Tb(1,"mat-label"),o.yc(2,"Tiempo supervisi\xf3n (sg.)"),o.Sb(),o.Tb(3,"mat-select",24),o.xc(4,O,2,2,"mat-option",11),o.Sb(),o.Sb()),2&e){const e=o.ec();o.Cb(3),o.kc("disabled",e.visualizationMode),o.Cb(1),o.kc("ngForOf",e.time)}}function T(e,t){if(1&e&&(o.Tb(0,"mat-option",21),o.yc(1),o.Sb()),2&e){const e=t.$implicit;o.kc("value",e.value),o.Cb(1),o.Ac(" ",e.viewValue," ")}}function _(e,t){if(1&e&&(o.Tb(0,"mat-option",21),o.yc(1),o.Sb()),2&e){const e=t.$implicit;o.kc("value",e.value),o.Cb(1),o.Ac(" ",e.viewValue," ")}}function w(e,t){if(1&e){const e=o.Ub();o.Tb(0,"mat-form-field",9),o.Tb(1,"mat-label"),o.yc(2,"Filtrar recursos..."),o.Sb(),o.Tb(3,"mat-select",25),o.ac("valueChange",function(t){return o.rc(e),o.ec().selectedOptFilter=t})("selectionChange",function(){return o.rc(e),o.ec().checkExtOptSelected()}),o.xc(4,_,2,2,"mat-option",11),o.Sb(),o.Sb()}if(2&e){const e=o.ec();o.Cb(3),o.kc("value",e.selectedOptFilter),o.Cb(1),o.kc("ngForOf",e.optionsFilter)}}function x(e,t){if(1&e){const e=o.Ub();o.Tb(0,"div",26),o.Tb(1,"mat-form-field",5),o.Tb(2,"mat-label"),o.yc(3,"Car\xe1cteres a buscar"),o.Sb(),o.Tb(4,"input",27),o.ac("change",function(t){return o.rc(e),o.ec().getFilterValue(t)}),o.Sb(),o.Sb(),o.Tb(5,"button",28),o.ac("click",function(){return o.rc(e),o.ec().checkExtOptSelected()}),o.yc(6," Buscar recursos "),o.Sb(),o.Sb()}}function P(e,t){if(1&e&&(o.Tb(0,"mat-option",21),o.yc(1),o.Sb()),2&e){const e=t.$implicit;o.kc("value",e.idemplazamiento),o.Cb(1),o.Ac(" ",e.eName," ")}}function R(e,t){if(1&e){const e=o.Ub();o.Tb(0,"mat-form-field",9),o.Tb(1,"mat-label"),o.yc(2,"Seleccione emplazamiento"),o.Sb(),o.Tb(3,"mat-select",29),o.ac("valueChange",function(t){return o.rc(e),o.ec().selectedSite=t})("selectionChange",function(){return o.rc(e),o.ec().getGateways()}),o.xc(4,P,2,2,"mat-option",11),o.Sb(),o.Sb()}if(2&e){const e=o.ec();o.Cb(3),o.kc("value",e.selectedSite),o.Cb(1),o.kc("ngForOf",e.sites.data)}}function M(e,t){if(1&e&&(o.Tb(0,"mat-option",21),o.yc(1),o.Sb()),2&e){const e=t.$implicit;o.kc("value",e.idpasarela),o.Cb(1),o.Ac(" ",e.gName," ")}}function N(e,t){if(1&e){const e=o.Ub();o.Tb(0,"mat-form-field",9),o.Tb(1,"mat-label"),o.yc(2,"Seleccione pasarela"),o.Sb(),o.Tb(3,"mat-select",30),o.ac("valueChange",function(t){return o.rc(e),o.ec().selectedGateway=t})("selectionChange",function(){return o.rc(e),o.ec().getConfResources()}),o.xc(4,M,2,2,"mat-option",11),o.Sb(),o.Sb()}if(2&e){const e=o.ec();o.Cb(3),o.kc("value",e.selectedGateway),o.Cb(1),o.kc("ngForOf",e.gateways)}}function F(e,t){if(1&e&&(o.Tb(0,"mat-option",21),o.yc(1),o.Sb()),2&e){const e=t.$implicit;o.kc("value",t.index),o.Cb(1),o.Ac(" ",e.rName," ")}}function I(e,t){if(1&e){const e=o.Ub();o.Tb(0,"mat-form-field",9),o.Tb(1,"mat-label"),o.yc(2,"Seleccione recurso"),o.Sb(),o.Tb(3,"mat-select",31),o.ac("valueChange",function(t){return o.rc(e),o.ec().selectedResource=t})("selectionChange",function(){o.rc(e);const t=o.ec();return t.checkIfAGVNNameExist(t.resources[t.selectedResource].rName)}),o.xc(4,F,2,2,"mat-option",11),o.Sb(),o.Sb()}if(2&e){const e=o.ec();o.Cb(3),o.kc("value",e.selectedResource),o.Cb(1),o.kc("ngForOf",e.resources)}}function V(e,t){if(1&e&&(o.Tb(0,"mat-option",21),o.yc(1),o.Sb()),2&e){const e=t.$implicit;o.kc("value",t.index),o.Cb(1),o.Ac(" ",e.rName," ")}}function A(e,t){if(1&e){const e=o.Ub();o.Tb(0,"mat-form-field",9),o.Tb(1,"mat-label"),o.yc(2,"Seleccione recurso"),o.Sb(),o.Tb(3,"mat-select",31),o.ac("valueChange",function(t){return o.rc(e),o.ec().selectedResource=t})("selectionChange",function(){o.rc(e);const t=o.ec();return t.checkIfAGVNNameExist(t.resources[t.selectedResource].rName)}),o.xc(4,V,2,2,"mat-option",11),o.Sb(),o.Sb()}if(2&e){const e=o.ec();o.Cb(3),o.kc("value",e.selectedResource),o.Cb(1),o.kc("ngForOf",e.resources)}}let G=(()=>{class e{constructor(e,t,i,c,o){this.userService=e,this.resourceService=t,this.dataService=i,this.configService=c,this.gatewayService=o,this.arrows="<<",this.resourceTypes=[{value:0,viewValue:"Recursos configurados"},{value:1,viewValue:"Recursos externos"}],this.optionsFilter=[{value:4,viewValue:"Buscar por Alias"},{value:5,viewValue:"Buscar por URI"},{value:3,viewValue:"Todos (Telefono)"}],this.time=[{value:5,viewValue:"5"},{value:10,viewValue:"10"},{value:15,viewValue:"15"},{value:20,viewValue:"20"},{value:25,viewValue:"25"},{value:30,viewValue:"30"}],this.supCollateral=[{value:0,viewValue:"No"},{value:1,viewValue:"A Usuario"},{value:2,viewValue:"A Dominio"}],this.selectedTypeResource=this.resourceTypes[0].value,this.displaySearchBar=!1,this.displaySites=!1,this.displaySelectFilter=!1,this.displayGateways=!1,this.visualizationMode=!1,this.displayTimeSelect=!1,this.displayOptResponse1=!1,this.displayOptResponse2=!1,this.displayConfResource=!1,this.displayExtResource=!1,this.sites=[],this.gateways=[],this.resources=[]}ngOnInit(){this.visualizationMode=!!this.visualizationPermission(),this.getSites(),this.resourceForm.patchValue({uri_telefonica:this.resourceForm.value.uri_telefonica.replace("sip:",""),additional_uri_remota:this.resourceForm.value.additional_uri_remota.replace("sip:","")}),this.checkResourceTypeSelected(),this.displaySupSelect()}visualizationPermission(){return!this.userService.isRole("ADMIN")&&!this.userService.isRole("CONFIGURATION")&&this.userService.isRole("VISUALIZATION")}checkResourceTypeSelected(){return Object(c.a)(this,void 0,void 0,function*(){0==this.selectedTypeResource?(yield this.getGateways(),yield this.getConfResources(),null!=this.selectedResource&&(yield this.checkIfAGVNNameExist(this.resources[this.selectedResource].rName)),this.displaySites=!0,this.displaySelectFilter=!1,this.displaySearchBar=!1,this.displayExtResource=!1):(yield this.checkExtOptSelected(),this.displaySites=!1,this.displaySelectFilter=!0,this.displaySearchBar=!0,this.displayGateways=!1,this.displayConfResource=!1)})}displaySupSelect(){this.displayOptResponse1=0!=this.resourceForm.value.supervisa_colateral,this.displayOptResponse2=0!=this.resourceForm.value.additional_superv_options,this.displayTimeSelect=this.displayOptResponse1||this.displayOptResponse2}getSites(){return Object(c.a)(this,void 0,void 0,function*(){const e=this.dataService.getDataConfigId();this.sites=yield this.resourceService.getCommunicationsSites(e).toPromise()})}getConfigName(){return Object(c.a)(this,void 0,void 0,function*(){const e=this.dataService.getDataConfigId();return(yield this.configService.getConfigurationById(e).toPromise()).result[0].NAME})}getGateways(){return Object(c.a)(this,void 0,void 0,function*(){let e=yield this.getConfigName();if(null!=this.selectedSite){let t=yield this.resourceService.getCollateralGateways(e,this.selectedSite).toPromise(),i=[];yield t.data.forEach(e=>{i.includes(e.gName)||(i.push(e.gName),this.gateways.push(e))}),this.displayGateways=!0}})}getConfResources(){return Object(c.a)(this,void 0,void 0,function*(){let e=yield this.getConfigName();null!=this.selectedSite&&null!=this.selectedGateway&&(this.resources=(yield this.resourceService.getTelResources(e,this.selectedSite,this.selectedGateway,2).toPromise()).data,this.displayConfResource=!0)})}makeURI(e=!1){let t="",i="",c="";null!=this.selectedResource&&(""!=this.telAGVNNameSelected&&null!=this.telAGVNNameSelected?(t=this.telAGVNNameSelected,i=0===this.selectedTypeResource?this.resources[this.selectedResource].gIpv:this.resources[this.selectedResource].gIpv.split("@")[1],c=`${t}@${i}`):(t=this.resources[this.selectedResource].rName,i=this.resources[this.selectedResource].gIpv,c=0===this.selectedTypeResource?`${t}@${i}`:this.resources[this.selectedResource].gIpv),this.resourceForm.patchValue(e?{additional_uri_remota:""+c}:{uri_telefonica:""+c}))}getFilterValue(e){this.stringToFilter=e.target.value}checkExtOptSelected(){return Object(c.a)(this,void 0,void 0,function*(){let e=[];switch(this.resources=[],this.telAGVNNameSelected="",this.selectedOptFilter){case 3:e=yield this.resourceService.getCommunicationsExtTelResources(this.selectedOptFilter).toPromise();break;case 4:case 5:e=yield this.resourceService.getCommunicationsFilteredTelResources(this.selectedOptFilter,this.stringToFilter).toPromise()}null!=e.lista_recursos&&(yield e.lista_recursos.forEach(e=>{this.resources.push({rName:e.alias,gIpv:e.uri})})),this.displayExtResource=!0})}checkIfAGVNNameExist(e){return Object(c.a)(this,void 0,void 0,function*(){let t;if(this.telhardwareResume=(yield this.gatewayService.getGatewayHardware(this.gatewayId).toPromise()).tfno,this.telhardwareResume.forEach(i=>{e===i.nombre&&(t=i.idrecurso_telefono)}),void 0!==t){let e=yield this.resourceService.getTelResource(t,2).toPromise();void 0!==e&&(this.telAGVNNameSelected=e.ats_user)}})}}return e.\u0275fac=function(t){return new(t||e)(o.Nb(a.a),o.Nb(s.a),o.Nb(n.a),o.Nb(l.a),o.Nb(r.a))},e.\u0275cmp=o.Hb({type:e,selectors:[["resource-collaterals"]],decls:48,vars:18,consts:[[1,"form",3,"formGroup"],[1,"title"],[1,"main-collaterals"],[1,"uris"],[1,"uri-row"],["appearance","legacy"],["matInput","","formControlName","uri_telefonica"],["mat-raised-button","",3,"disabled","click"],[1,"supCollSelect"],["appearance","fill"],["name","supCollateral","formControlName","supervisa_colateral",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["class","checkbox","formControlName","itiporespuesta",4,"ngIf"],[1,"hr"],["matInput","","formControlName","additional_uri_remota"],["name","supCollateral","formControlName","additional_superv_options",3,"selectionChange"],["class","checkbox add-iti","formControlName","additional_itiporespuesta",4,"ngIf"],["appearance","fill",4,"ngIf"],[1,"telephonic-resources"],["name","resourceTypes",3,"value","selectionChange","valueChange"],["class","filter",4,"ngIf"],[3,"value"],["formControlName","itiporespuesta",1,"checkbox"],["formControlName","additional_itiporespuesta",1,"checkbox","add-iti"],["name","timeSup","formControlName","tiempo_supervision",3,"disabled"],["name","optionsFilter",3,"value","valueChange","selectionChange"],[1,"filter"],["matInput","",3,"change"],["mat-raised-button","",3,"click"],["name","sites",3,"value","valueChange","selectionChange"],["name","gateways",3,"value","valueChange","selectionChange"],["name","resources",3,"value","valueChange","selectionChange"]],template:function(e,t){1&e&&(o.Tb(0,"form",0),o.Tb(1,"div",1),o.Tb(2,"mat-label"),o.yc(3,"Colaterales"),o.Sb(),o.Sb(),o.Tb(4,"div",2),o.Tb(5,"div",3),o.Tb(6,"div",4),o.Tb(7,"mat-form-field",5),o.Tb(8,"mat-label"),o.yc(9,"NombreRecurso@IP:Puerto"),o.Sb(),o.Ob(10,"input",6),o.Sb(),o.Tb(11,"button",7),o.ac("click",function(){return t.makeURI()}),o.yc(12),o.Sb(),o.Sb(),o.Tb(13,"div",8),o.Tb(14,"mat-form-field",9),o.Tb(15,"mat-label"),o.yc(16,"Supervisa Colateral"),o.Sb(),o.Tb(17,"mat-select",10),o.ac("selectionChange",function(){return t.displaySupSelect()}),o.xc(18,C,2,2,"mat-option",11),o.Sb(),o.Sb(),o.Sb(),o.xc(19,v,2,0,"mat-checkbox",12),o.Ob(20,"hr",13),o.Tb(21,"div",4),o.Tb(22,"mat-form-field",5),o.Tb(23,"mat-label"),o.yc(24,"NombreRecurso@IP:Puerto"),o.Sb(),o.Ob(25,"input",14),o.Sb(),o.Tb(26,"button",7),o.ac("click",function(){return t.makeURI(!0)}),o.yc(27),o.Sb(),o.Sb(),o.Tb(28,"div",8),o.Tb(29,"mat-form-field",9),o.Tb(30,"mat-label"),o.yc(31," Supervisa Colateral"),o.Sb(),o.Tb(32,"mat-select",15),o.ac("selectionChange",function(){return t.displaySupSelect()}),o.xc(33,S,2,2,"mat-option",11),o.Sb(),o.Sb(),o.Sb(),o.xc(34,y,2,0,"mat-checkbox",16),o.xc(35,k,5,2,"mat-form-field",17),o.Sb(),o.Tb(36,"div",18),o.Tb(37,"mat-form-field",9),o.Tb(38,"mat-label"),o.yc(39,"Seleccione tipo de recurso"),o.Sb(),o.Tb(40,"mat-select",19),o.ac("selectionChange",function(){return t.checkResourceTypeSelected()})("valueChange",function(e){return t.selectedTypeResource=e}),o.xc(41,T,2,2,"mat-option",11),o.Sb(),o.Sb(),o.xc(42,w,5,2,"mat-form-field",17),o.xc(43,x,7,0,"div",20),o.xc(44,R,5,2,"mat-form-field",17),o.xc(45,N,5,2,"mat-form-field",17),o.xc(46,I,5,2,"mat-form-field",17),o.xc(47,A,5,2,"mat-form-field",17),o.Sb(),o.Sb(),o.Sb()),2&e&&(o.kc("formGroup",t.resourceForm),o.Cb(11),o.kc("disabled",t.visualizationMode),o.Cb(1),o.Ac(" ",t.arrows," "),o.Cb(6),o.kc("ngForOf",t.supCollateral),o.Cb(1),o.kc("ngIf",t.displayOptResponse1),o.Cb(7),o.kc("disabled",t.visualizationMode),o.Cb(1),o.Ac(" ",t.arrows," "),o.Cb(6),o.kc("ngForOf",t.supCollateral),o.Cb(1),o.kc("ngIf",t.displayOptResponse2),o.Cb(1),o.kc("ngIf",t.displayTimeSelect),o.Cb(5),o.kc("value",t.selectedTypeResource),o.Cb(1),o.kc("ngForOf",t.resourceTypes),o.Cb(1),o.kc("ngIf",t.displaySelectFilter),o.Cb(1),o.kc("ngIf",4==t.selectedOptFilter||5==t.selectedOptFilter&&t.displaySelectFilter),o.Cb(1),o.kc("ngIf",t.displaySites),o.Cb(1),o.kc("ngIf",t.displayGateways),o.Cb(1),o.kc("ngIf",t.displayConfResource),o.Cb(1),o.kc("ngIf",t.displayExtResource))},directives:[u.z,u.s,u.k,d.f,d.c,b.b,u.c,u.r,u.i,m.a,p.a,h.k,h.l,f.j,g.a],styles:[".main-collaterals[_ngcontent-%COMP%]{display:grid;grid-auto-flow:column;grid-column-gap:10px}.main-collaterals[_ngcontent-%COMP%]   .uris[_ngcontent-%COMP%]{display:flex;flex-direction:column}.main-collaterals[_ngcontent-%COMP%]   .uris[_ngcontent-%COMP%]   .uri-row[_ngcontent-%COMP%]{display:grid;grid-auto-flow:column;grid-column-gap:10px}.main-collaterals[_ngcontent-%COMP%]   .uris[_ngcontent-%COMP%]   .uri-row[_ngcontent-%COMP%]   .supCollSelect[_ngcontent-%COMP%], .main-collaterals[_ngcontent-%COMP%]   .uris[_ngcontent-%COMP%]   .uri-row[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}.main-collaterals[_ngcontent-%COMP%]   .uris[_ngcontent-%COMP%]   .uri-row[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:auto}.main-collaterals[_ngcontent-%COMP%]   .uris[_ngcontent-%COMP%]   .uri-row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.main-collaterals[_ngcontent-%COMP%]   .uris[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{display:flex;padding:0 .75em;line-height:40px}.main-collaterals[_ngcontent-%COMP%]   .uris[_ngcontent-%COMP%]   .checkbox.add-iti[_ngcontent-%COMP%]{margin-bottom:15px}.main-collaterals[_ngcontent-%COMP%]   .uris[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   mat-checkbox.mat-checkbox-checked[_ngcontent-%COMP%]     .mat-checkbox-background{background-color:#48803e!important}.main-collaterals[_ngcontent-%COMP%]   .uris[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   mat-checkbox.mat-checkbox-disabled[_ngcontent-%COMP%]     .mat-checkbox-background{background-color:#b0b0b0!important}.main-collaterals[_ngcontent-%COMP%]   .uris[_ngcontent-%COMP%]   .hr[_ngcontent-%COMP%]{border:0;clear:both;display:block;width:100%;background-color:grey;height:1px;margin:20px 0}.main-collaterals[_ngcontent-%COMP%]   .telephonic-resources[_ngcontent-%COMP%]{display:flex;flex-direction:column}.main-collaterals[_ngcontent-%COMP%]   .telephonic-resources[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]{display:inline-grid;margin-bottom:2px}.main-collaterals[_ngcontent-%COMP%]   .telephonic-resources[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:-webkit-max-content;width:max-content;margin:auto}"]}),e})()}}]);